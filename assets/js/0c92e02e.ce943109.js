"use strict";(self.webpackChunkncm_301=self.webpackChunkncm_301||[]).push([[4104],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>h});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),s=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},m=function(e){var t=s(e.components);return n.createElement(l.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},k=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,m=p(e,["components","mdxType","originalType","parentName"]),c=s(a),k=r,h=c["".concat(l,".").concat(k)]||c[k]||d[k]||o;return a?n.createElement(h,i(i({ref:t},m),{},{components:a})):n.createElement(h,i({ref:t},m))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=k;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p[c]="string"==typeof e?e:r,i[1]=p;for(var s=2;s<o;s++)i[s]=a[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},50108:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>p,toc:()=>s});var n=a(87462),r=(a(67294),a(3905));const o={title:"Calm: Day 2 Operations"},i="Overview",p={unversionedId:"calm_windows_track/calm_day2_windows/calm_day2_windows",id:"calm_windows_track/calm_day2_windows/calm_day2_windows",title:"Calm: Day 2 Operations",description:'In the calm_linux{.interpreted-text role="ref"} and',source:"@site/docs/calm_windows_track/calm_day2_windows/calm_day2_windows.mdx",sourceDirName:"calm_windows_track/calm_day2_windows",slug:"/calm_windows_track/calm_day2_windows/",permalink:"/ncm301/calm_windows_track/calm_day2_windows/",draft:!1,editUrl:"https://github.com/mat0606/ncm301/edit/main/docs/calm_windows_track/calm_day2_windows/calm_day2_windows.mdx",tags:[],version:"current",frontMatter:{title:"Calm: Day 2 Operations"}},l={},s=[],m={toc:s},c="wrapper";function d(e){let{components:t,...o}=e;return(0,r.kt)(c,(0,n.Z)({},m,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"overview"},"Overview"),(0,r.kt)("p",null,"In the ",(0,r.kt)("inlineCode",{parentName:"p"},"calm_linux"),'{.interpreted-text role="ref"} and\n',(0,r.kt)("inlineCode",{parentName:"p"},"calm_win"),'{.interpreted-text role="ref"} labs you explored how Calm can\nbe used to model and deploy complex applications using a blueprint.\nCalm, however, it capable of managing applications throughout their\n',(0,r.kt)("strong",{parentName:"p"},"entire")," lifecycle."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},'In this lab you will implement custom actions within Calm to address\n\\"Day 2\\" operations, including scaling out, scaling in, and upgrading\nyour application.')),(0,r.kt)("h1",{id:"lab-setup"},"Lab Setup"),(0,r.kt)("p",null,"This lab depends on the availability of a multi-tier ",(0,r.kt)("strong",{parentName:"p"},"Task Manger")," web\napplication implemented during the ",(0,r.kt)("inlineCode",{parentName:"p"},"calm_linux"),'{.interpreted-text\nrole="ref"} lab.'),(0,r.kt)("h1",{id:"scaling-out"},"Scaling Out"),(0,r.kt)("p",null,"Imagine you\\'re the administrator of the Task Manager application that\nwe\\'ve been building, and you\\'re currently unsure of the amount of\ndemand for this application by your end users. Or, potentially, you\nexpect the demand to ebb and flow due to the time of the year. How can\nwe easily scale to meet this changing demand?"),(0,r.kt)("p",null,"During the creation of the Task Manager blueprint, the ",(0,r.kt)("strong",{parentName:"p"},"WebServer"),"\nservice was configured with a minimum number of 2 replicas, with a\nmaximum of 4. As a result, Calm will create 2 WebServer VMs during the\ninitial deployment. In the event the 2 replicas are not enough to handle\nthe load of your end users, a ",(0,r.kt)("strong",{parentName:"p"},"Scale Out")," operation is required."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In the ",(0,r.kt)("strong",{parentName:"p"},"Application Overview ",">"," Application Profile")," section,\nexpand the ",(0,r.kt)("strong",{parentName:"p"},"Default")," Application Profile."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(78987).Z,width:"234",height:"434"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("inlineCode",{parentName:"p"},"plus-circle"),'{.interpreted-text role="fa"} next to\n',(0,r.kt)("strong",{parentName:"p"},"Actions")," to add a new, custom action. On the ",(0,r.kt)("strong",{parentName:"p"},"Configuration\nPane")," to the right, rename the new Action to be ",(0,r.kt)("strong",{parentName:"p"},"Scale Out"),"."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(97813).Z,width:"785",height:"451"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In the box ",(0,r.kt)("strong",{parentName:"p"},"below")," the ",(0,r.kt)("strong",{parentName:"p"},"WebServer")," service tile, click the ",(0,r.kt)("strong",{parentName:"p"},"+\nTask")," button to add a scaling task, and fill out the following\nfields:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Task Name")," - web_scale_out"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Scaling Type")," - Scale Out"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Scaling Count")," - 1")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(34310).Z,width:"337",height:"277"})),(0,r.kt)("p",{parentName:"li"},"::: note\n::: title\nNote\n:::"),(0,r.kt)("p",{parentName:"li"},"The ",(0,r.kt)("strong",{parentName:"p"},"+ Task")," button that appears below the service tile is only\nused for scaling the number of replicas up and down, so it is\nimportant to select the correct option.\n:::"),(0,r.kt)("p",{parentName:"li"},"When a user later runs the ",(0,r.kt)("strong",{parentName:"p"},"Scale Out")," task, a new ",(0,r.kt)("strong",{parentName:"p"},"WebServer"),"\nVM will get created, and the ",(0,r.kt)("strong",{parentName:"p"},"Package Install")," tasks for that\nservice will be executed. However, we do need to modify the\n",(0,r.kt)("strong",{parentName:"p"},"HAProxy")," configuration in order to start taking advantage of this\nnew web server.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Within")," the ",(0,r.kt)("strong",{parentName:"p"},"HAProxy")," service tile, click the ",(0,r.kt)("strong",{parentName:"p"},"+ Task"),"\nbutton, then fill out the following fields:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Task Name")," - add_webserver"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Type")," - Execute"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Script Type")," - Shell"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Credential")," - CENTOS"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy and paste the following script into the ",(0,r.kt)("strong",{parentName:"p"},"Script")," field:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\nset -ex\n\nhost=$(echo "@@{WebServer.address}@@" | awk -F "," \'{print $NF}\')\nport=80\necho " server host-${host} ${host}:${port} weight 1 maxconn 100 check" | sudo tee -a /etc/haproxy/haproxy.cfg\n\nsudo systemctl daemon-reload\nsudo systemctl restart haproxy\n')),(0,r.kt)("p",{parentName:"li"},"The script will parse the last IP address in the WebServer address\narray and append it to the haproxy.cfg file. However, we want to be\nsure that this doesn\\'t happen until ",(0,r.kt)("strong",{parentName:"p"},"after")," the new WebServer is\nfully up, otherwise the HAProxy server may send requests to a\nnon-functioning WebServer.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"To solve this issue, create an edge to force a dependency on the\n",(0,r.kt)("strong",{parentName:"p"},"web_scale_out")," task completing prior to the ",(0,r.kt)("strong",{parentName:"p"},"add_webserver"),"\ntask."),(0,r.kt)("p",{parentName:"li"},"Your ",(0,r.kt)("strong",{parentName:"p"},"Workspace")," should now look like this:"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(10822).Z,width:"818",height:"486"})))),(0,r.kt)("h1",{id:"scaling-in"},"Scaling In"),(0,r.kt)("p",null,"It\\'s the end of your busy season, and you\\'d like to optimize your\nresource utilization by scaling back the number of deployed Web Servers."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("inlineCode",{parentName:"p"},"plus-circle"),'{.interpreted-text role="fa"} to add a custom\naction named ',(0,r.kt)("strong",{parentName:"p"},"Scale In")," to the Default ",(0,r.kt)("strong",{parentName:"p"},"Application Profile"),"."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(76825).Z,width:"783",height:"488"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Below")," the ",(0,r.kt)("strong",{parentName:"p"},"WebServer")," service tile, click the ",(0,r.kt)("strong",{parentName:"p"},"+ Task"),"\nbutton to add a scaling task, and fill out the following fields:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Task Name")," - web_scale_in"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Scaling Type")," - Scale In"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Scaling Count")," - 1")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(35217).Z,width:"338",height:"277"})),(0,r.kt)("p",{parentName:"li"},"When a user later runs the ",(0,r.kt)("strong",{parentName:"p"},"Scale In")," task, the last ",(0,r.kt)("strong",{parentName:"p"},"WebServer"),"\nreplica will have its ",(0,r.kt)("strong",{parentName:"p"},"Package Uninstall")," task run, the VM will be\nshut down, and then deleted, which will reclaim resources. However,\nwe do need to modify the ",(0,r.kt)("strong",{parentName:"p"},"HAProxy")," configuration to ensure that\nwe\\'re no longer sending traffic to the to-be-deleted Web Server.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Within")," the ",(0,r.kt)("strong",{parentName:"p"},"HAProxy")," service tile, click the ",(0,r.kt)("strong",{parentName:"p"},"+ Task"),"\nbutton, then fill out the following fields:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Task Name")," - del_webserver"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Type")," - Execute"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Script Type")," - Shell"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Credential")," - CENTOS"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy and paste the following script into the ",(0,r.kt)("strong",{parentName:"p"},"Script")," field:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\nset -ex\n\nhost=$(echo "@@{WebServer.address}@@" | awk -F "," \'{print $NF}\')\nsudo sed -i "/$host/d" /etc/haproxy/haproxy.cfg\n\nsudo systemctl daemon-reload\nsudo systemctl restart haproxy\n')),(0,r.kt)("p",{parentName:"li"},"Similar to the scale out script, this script will parse the last IP\nin the WebServer address array and use the\n",(0,r.kt)("a",{parentName:"p",href:"http://www.grymoire.com/Unix/Sed.html"},"sed")," command to remove the\ncorresponding entry from haproxy.cfg."),(0,r.kt)("p",{parentName:"li"},"Again, similar to the scale out script, we want to ensure requests\nstop being sent to the VM ",(0,r.kt)("strong",{parentName:"p"},"before")," it is removed.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"To solve this issue, create an edge to force a dependency on the\n",(0,r.kt)("strong",{parentName:"p"},"del_webserver")," task completing prior to the ",(0,r.kt)("strong",{parentName:"p"},"web_scale_in"),"\ntask."),(0,r.kt)("p",{parentName:"li"},"Your ",(0,r.kt)("strong",{parentName:"p"},"Workspace")," should now look like this:"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(72509).Z,width:"806",height:"519"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Save")," and ensure no errors or warnings pop-up. If they do,\nresolve the issue, and ",(0,r.kt)("strong",{parentName:"p"},"Save")," again."))),(0,r.kt)("h1",{id:"upgrading"},"Upgrading"),(0,r.kt)("p",null,"Your company has a mandate to keep all application code up to date, to\nhelp minimize security vulnerabilities. Your company also has a strict\nchange control process, meaning you can only update your application\nduring the weekend. You currently spend a significant portion of your\ntime on one Saturday every month completing application update\nprocedures during a maintenance window. Let\\'s look at how you can\nreclaim your weekend by modeling the application upgrade with Calm."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("inlineCode",{parentName:"p"},"plus-circle"),'{.interpreted-text role="fa"} to add a custom\naction named ',(0,r.kt)("strong",{parentName:"p"},"Upgrade")," to the Default ",(0,r.kt)("strong",{parentName:"p"},"Application Profile"),"."),(0,r.kt)("p",{parentName:"li"},"The first thing we\\'re going to need to do is to stop the respective\nprocesses on each of our Services.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Within each")," of our 3 Services, click the ",(0,r.kt)("strong",{parentName:"p"},"+ Task")," button to\nadd a new task, and fill in the following information:"),(0,r.kt)("hr",{parentName:"li"}),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Service Name"),"   MySQL       WebServer       HAProxy"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Task Name"),"      StopMySQL   StopWebServer   StopHAProxy"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Type"),"           Execute     Execute         Execute"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Script Type"),"    Shell       Shell           Shell"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Credential"),"     CENTOS      CENTOS          CENTOS"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Script"),"         See Below   See Below       See Below"),(0,r.kt)("hr",{parentName:"li"}),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"StopMySQL Script:")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\nset -ex\n\nsudo systemctl stop mysqld\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"StopWebServer Script:")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\nset -ex\n\nsudo systemctl stop php-fpm\nsudo systemctl stop nginx\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"StopHAProxy Script:")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\nset -ex\n\nsudo systemctl stop haproxy\n")),(0,r.kt)("p",{parentName:"li"},"Once complete, your ",(0,r.kt)("strong",{parentName:"p"},"Workspace")," should look like this:"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(80260).Z,width:"1224",height:"611"})),(0,r.kt)("p",{parentName:"li"},"Similar to both scaling and initial deployment operations, we do not\nwant to get into a situation where the WebServer goes down before\nthe HAProxy, nor do we want the MySQL database to go down before the\nWebServers.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Create edges between services such that HAProxy stops before\nWebServers, and all WebServers stop before MySQL:"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(67557).Z,width:"798",height:"486"})),(0,r.kt)("p",{parentName:"li"},"Now that our critical services are stopped, we\\'ll want to perform\nour updates.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Again, ",(0,r.kt)("strong",{parentName:"p"},"within each")," Service, add a new Task. All of the 3 tasks\nare identical other than the name:"),(0,r.kt)("hr",{parentName:"li"}),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Service Name"),"   MySQL          WebServer          HAProxy"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Task Name"),"      UpgradeMySQL   UpgradeWebServer   UpgradeHAProxy"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Type"),"           Execute        Execute            Execute"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Script Type"),"    Shell          Shell              Shell"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Credential"),"     CENTOS         CENTOS             CENTOS"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Script"),"         See Below      See Below          See Below"),(0,r.kt)("hr",{parentName:"li"}),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Script for all 3 Upgrade Tasks:")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\nset -ex\n\nsudo yum update -y\n")),(0,r.kt)("p",{parentName:"li"},"This script will use the Red Hat/CentOS package management tool,\n",(0,r.kt)("a",{parentName:"p",href:"https://access.redhat.com/solutions/9934"},"yum")," to search for and\ninstall updates to all installed packages."),(0,r.kt)("p",{parentName:"li"},"Your ",(0,r.kt)("strong",{parentName:"p"},"Workspace")," should now look like this:"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(66448).Z,width:"830",height:"502"})),(0,r.kt)("p",{parentName:"li"},"From an a task ordering perspective, do we need to draw any\norchestration edges? Notice in the screenshot above that Calm\nautomatically draws and edge from the ",(0,r.kt)("strong",{parentName:"p"},"Stop")," task to the\n",(0,r.kt)("strong",{parentName:"p"},"Upgrade")," task, which is good as that\\'s required. However, do we\nneed any side to side dependencies?"),(0,r.kt)("p",{parentName:"li"},"If you said \\\"no\\\", you\\'re correct. The critical components are\nstarting and stopping of the Services, there\\'s no reason to have\neach Service upgrade one at a time."),(0,r.kt)("p",{parentName:"li"},"Unless you specify otherwise, Calm will always run tasks in parallel\nto save time."),(0,r.kt)("p",{parentName:"li"},"Now that our Services have been upgraded, it\\'s time to start them.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Again, we\\'ll add a Task ",(0,r.kt)("strong",{parentName:"p"},"within each")," Service, with the following\nvalues:"),(0,r.kt)("hr",{parentName:"li"}),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Service Name"),"   MySQL          WebServer          HAProxy"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Task Name"),"      StartMySQL     StartWebServer     StartHAProxy"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Type"),"           Execute        Execute            Execute"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Script Type"),"    Shell          Shell              Shell"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Credential"),"     CENTOS         CENTOS             CENTOS"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"Script"),"         See Below      See Below          See Below"),(0,r.kt)("hr",{parentName:"li"}),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"StartMySQL Script:")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\nset -ex\n\nsudo systemctl start mysqld\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"StartWebServer Script:")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\nset -ex\n\nsudo systemctl start php-fpm\nsudo systemctl start nginx\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"StartHAProxy Script:")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\nset -ex\n\nsudo systemctl start haproxy\n")),(0,r.kt)("p",{parentName:"li"},"Your ",(0,r.kt)("strong",{parentName:"p"},"Workspace")," should now look like this:"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(73082).Z,width:"839",height:"538"})),(0,r.kt)("p",{parentName:"li"},"This time, we ",(0,r.kt)("strong",{parentName:"p"},"DO")," require additional orchestration edges. As\npreviously discussed, we would not want our HAProxy service up\nbefore our WebServers, or our WebServers up before our MySQL\ndatabase.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Create orchestration edges starting with MySQL, then the WebServers,\nand lastly the HAProxy:"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(82578).Z,width:"815",height:"564"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Save")," and ensure no errors or warnings pop-up. If they do,\nresolve the issue, and ",(0,r.kt)("strong",{parentName:"p"},"Save")," again."))),(0,r.kt)("h1",{id:"launching-and-managing-the-application"},"Launching and Managing the Application"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"From the upper toolbar in the Blueprint Editor, click ",(0,r.kt)("strong",{parentName:"p"},"Launch"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Specify a unique ",(0,r.kt)("strong",{parentName:"p"},"Application Name")," (e.g.\n",(0,r.kt)("em",{parentName:"p"},"Initials"),"-CalmLinuxIntro1) and your ",(0,r.kt)("strong",{parentName:"p"},"User_initials")," Runtime\nvariable value for VM naming.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("strong",{parentName:"p"},"Create"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Once the application reaches a ",(0,r.kt)("strong",{parentName:"p"},"Running")," status, navigate to the\n",(0,r.kt)("strong",{parentName:"p"},"Manage")," tab, and run the ",(0,r.kt)("strong",{parentName:"p"},"Scale Out")," action."),(0,r.kt)("p",{parentName:"li"},"Changes to the application can be monitored on the ",(0,r.kt)("strong",{parentName:"p"},"Audit")," tab."),(0,r.kt)("p",{parentName:"li"},"Once the scaling operation has completed, you can log into the\nHAProxy VM and verify the new Web Server has been added to\n",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/haproxy/haproxy.cfg"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Run the ",(0,r.kt)("strong",{parentName:"p"},"Upgrade")," action to update each service.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Finally, run the ",(0,r.kt)("strong",{parentName:"p"},"Scale In")," action to remove the additional Web\nServer VM."))),(0,r.kt)("h1",{id:"optional-variable-scaling"},"(Optional) Variable Scaling"),(0,r.kt)("p",null,"In this lab you configured scaling operations that expanded or shrank\nthe WebServer service array by a single VM."),(0,r.kt)("p",null,"When creating a new custom action, additional variables can be defined\nin the Configuration Pane specific to that action."),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(68139).Z,width:"271",height:"413"})),(0,r.kt)("p",null,"Leveraging a runtime variable, can you modify the scale out or scale in\nactions to perform a variable scaling operation?"),(0,r.kt)("p",null,"This will require some bash scripting experience to ensure the\nappropriate number of entries are being added and/or removed from the\nhaproxy.cfg file."),(0,r.kt)("h1",{id:"takeaways"},"Takeaways"),(0,r.kt)("p",null,"What are the key things you should know about ",(0,r.kt)("strong",{parentName:"p"},"Nutanix Calm"),"?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Not only can Calm orchestrate complex application deployments, it\ncan manage applications throughout their entire lifecycle, by\nmodeling complex Day 2 operations."),(0,r.kt)("li",{parentName:"ul"},"Whether it\\'s a built in task, like scaling, or a custom task, like\nupgrades, Calm can be directed to perform the operations in specific\norder, or if order doesn\\'t matter, perform them in parallel to save\non time."),(0,r.kt)("li",{parentName:"ul"},"What operation are you currently doing on a regular basis? It\\'s\nlikely that it can be modeled in Calm, saving you countless hours.\nTake back your weekend!")))}d.isMDXComponent=!0},76825:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/510scalein1-fee39c559799ac0b8bbcfa6524412c72.png"},35217:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/510scalein2-d4f9fd55fbd1283d14cf3e7ed7318d3d.png"},72509:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/510scalein3-f8bb90607df2e9cb1f5481b0b248e360.png"},78987:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/510scaleout0-5819c0e9eae5abb453451bc839a2d4a0.png"},97813:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/510scaleout1-15e5a7d468ab43948d83c6e0f63dba01.png"},34310:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/510scaleout2-982570ea6d9e6eca9350c7b80ea0ef65.png"},10822:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/510scaleout3-e4229c8d91c61797a9def9df429af23f.png"},68139:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/optional1-cc0062ef6b33b093d86cf3aef30724cf.png"},80260:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/upgrade1-ae4c3a6751451b3a2e3238c38714377f.png"},67557:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/upgrade2-9cfa88a933b158963837cf356c0eadd4.png"},66448:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/upgrade3-b87175489b8ccb39ed51c240b8b33421.png"},73082:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/upgrade4-6eebc4ba58595c8fce8e8fab041ba523.png"},82578:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/upgrade5-c2eae6b6911df21b7ee1067fb6d7aa9a.png"}}]);